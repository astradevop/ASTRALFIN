{% extends 'base.html' %}

{% block title %}{{ investment.investment_name }} - ASTRALFIN{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto py-12">
    <!-- Back Button -->
    <div class="mb-6">
        <a href="{% url 'investments:portfolio_view' %}" class="inline-flex items-center gap-2 text-slate-400 hover:text-white transition-colors">
            <i data-lucide="arrow-left" class="h-4 w-4"></i>
            Back to Portfolio
        </a>
    </div>
    
    <!-- Investment Header -->
    <div class="card-hover rounded-3xl bg-gradient-to-br from-slate-900/90 to-slate-800/80 border border-white/20 p-8 mb-6">
        <div class="flex flex-col md:flex-row md:items-start md:justify-between gap-6">
            <div class="flex items-start gap-4">
                <div class="h-16 w-16 rounded-2xl bg-gradient-to-br from-teal-500 to-cyan-400 flex items-center justify-center flex-shrink-0">
                    <i data-lucide="{% if investment.investment_type == 'Mutual_Fund' %}bar-chart{% elif investment.investment_type == 'Stocks' %}line-chart{% elif investment.investment_type == 'Bonds' %}shield{% elif investment.investment_type == 'Fixed_Deposit' %}lock{% else %}repeat{% endif %}" class="h-8 w-8 text-white"></i>
                </div>
                <div>
                    <h1 class="text-3xl font-bold mb-2">{{ investment.investment_name }}</h1>
                    <div class="flex flex-wrap items-center gap-2 text-sm">
                        <span class="inline-flex items-center gap-1 px-3 py-1 rounded-lg bg-white/10 text-slate-300">
                            <i data-lucide="tag" class="h-4 w-4"></i>
                            {{ investment.get_investment_type_display }}
                        </span>
                        <span class="inline-flex items-center gap-1 px-3 py-1 rounded-lg bg-white/10 text-slate-300">
                            <i data-lucide="alert-triangle" class="h-4 w-4"></i>
                            {{ investment.get_risk_level_display }} Risk
                        </span>
                        <span class="inline-flex items-center gap-1 px-3 py-1 rounded-lg {% if investment.investment_status == 'Active' %}bg-green-500/20 text-green-400 border border-green-500/30{% elif investment.investment_status == 'Closed' %}bg-red-500/20 text-red-400 border border-red-500/30{% else %}bg-yellow-500/20 text-yellow-400 border border-yellow-500/30{% endif %}">
                            <i data-lucide="circle" class="h-3 w-3 fill-current"></i>
                            {{ investment.investment_status }}
                        </span>
                    </div>
                </div>
            </div>
            
            {% if investment.investment_status == 'Active' %}
            <a href="{% url 'investments:withdraw_investment' investment.id %}" 
               class="px-6 py-3 rounded-xl bg-gradient-to-r from-red-500 to-pink-500 text-white font-semibold hover:from-red-400 hover:to-pink-400 flex items-center gap-2 transition-all">
                <i data-lucide="trending-down" class="h-5 w-5"></i>
                Withdraw
            </a>
            {% endif %}
        </div>
    </div>
    
    <!-- Investment Stats -->
    <div class="grid md:grid-cols-4 gap-6 mb-6">
        <div class="card-hover rounded-2xl bg-gradient-to-br from-slate-900/90 to-slate-800/80 border border-white/10 p-6">
            <div class="flex items-center gap-3 mb-2">
                <div class="h-10 w-10 rounded-lg bg-gradient-to-br from-blue-500 to-cyan-400 flex items-center justify-center">
                    <i data-lucide="wallet" class="h-5 w-5 text-white"></i>
                </div>
                <p class="text-sm text-slate-400">Principal Amount</p>
            </div>
            <p class="text-2xl font-bold">₹{{ investment.principal_amount|floatformat:2 }}</p>
        </div>
        
        <div class="card-hover rounded-2xl bg-gradient-to-br from-slate-900/90 to-slate-800/80 border border-white/10 p-6">
            <div class="flex items-center gap-3 mb-2">
                <div class="h-10 w-10 rounded-lg bg-gradient-to-br from-green-500 to-emerald-400 flex items-center justify-center">
                    <i data-lucide="dollar-sign" class="h-5 w-5 text-white"></i>
                </div>
                <p class="text-sm text-slate-400">Current Value</p>
            </div>
            <p class="text-2xl font-bold">₹{{ investment.current_value|floatformat:2 }}</p>
        </div>
        
        <div class="card-hover rounded-2xl bg-gradient-to-br from-slate-900/90 to-slate-800/80 border border-white/10 p-6">
            <div class="flex items-center gap-3 mb-2">
                <div class="h-10 w-10 rounded-lg bg-gradient-to-br from-{% if investment.profit_loss >= 0 %}green-500 to-emerald-400{% else %}red-500 to-pink-400{% endif %} flex items-center justify-center">
                    <i data-lucide="{% if investment.profit_loss >= 0 %}trending-up{% else %}trending-down{% endif %}" class="h-5 w-5 text-white"></i>
                </div>
                <p class="text-sm text-slate-400">Profit/Loss</p>
            </div>
            <p class="text-2xl font-bold {% if investment.profit_loss >= 0 %}text-green-400{% else %}text-red-400{% endif %}">
                {% if investment.profit_loss >= 0 %}+{% endif %}₹{{ investment.profit_loss|floatformat:2 }}
            </p>
        </div>
        
        <div class="card-hover rounded-2xl bg-gradient-to-br from-slate-900/90 to-slate-800/80 border border-white/10 p-6">
            <div class="flex items-center gap-3 mb-2">
                <div class="h-10 w-10 rounded-lg bg-gradient-to-br from-purple-500 to-pink-400 flex items-center justify-center">
                    <i data-lucide="percent" class="h-5 w-5 text-white"></i>
                </div>
                <p class="text-sm text-slate-400">Returns</p>
            </div>
            <p class="text-2xl font-bold {% if investment.return_percentage >= 0 %}text-green-400{% else %}text-red-400{% endif %}">
                {% if investment.return_percentage >= 0 %}+{% endif %}{{ investment.return_percentage|floatformat:2 }}%
            </p>
        </div>
    </div>
    
    <!-- Investment Details -->
    <div class="grid md:grid-cols-2 gap-6 mb-6">
        <div class="rounded-2xl bg-gradient-to-br from-slate-900/90 to-slate-800/80 border border-white/10 p-6">
            <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                <i data-lucide="info" class="h-5 w-5 text-teal-400"></i>
                Investment Information
            </h2>
            <div class="space-y-3">
                <div class="flex justify-between items-center py-2 border-b border-white/5">
                    <span class="text-slate-400">Expected Return Rate</span>
                    <span class="font-semibold">{{ investment.expected_return_rate }}% p.a.</span>
                </div>
                <div class="flex justify-between items-center py-2 border-b border-white/5">
                    <span class="text-slate-400">Start Date</span>
                    <span class="font-semibold">{{ investment.start_date|date:"d M, Y" }}</span>
                </div>
                {% if investment.maturity_date %}
                <div class="flex justify-between items-center py-2 border-b border-white/5">
                    <span class="text-slate-400">Maturity Date</span>
                    <span class="font-semibold">{{ investment.maturity_date|date:"d M, Y" }}</span>
                </div>
                {% endif %}
                <div class="flex justify-between items-center py-2">
                    <span class="text-slate-400">Risk Level</span>
                    <span class="font-semibold inline-flex items-center gap-1">
                        <i data-lucide="alert-triangle" class="h-4 w-4 {% if investment.risk_level == 'High' %}text-red-400{% elif investment.risk_level == 'Medium' %}text-yellow-400{% else %}text-green-400{% endif %}"></i>
                        {{ investment.get_risk_level_display }}
                    </span>
                </div>
            </div>
        </div>
        
        {% if investment.notes %}
        <div class="rounded-2xl bg-gradient-to-br from-slate-900/90 to-slate-800/80 border border-white/10 p-6">
            <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                <i data-lucide="file-text" class="h-5 w-5 text-teal-400"></i>
                Notes
            </h2>
            <p class="text-slate-300 leading-relaxed">{{ investment.notes }}</p>
        </div>
        {% endif %}
    </div>
    
    <!-- Transaction History -->
    <div class="rounded-2xl bg-gradient-to-br from-slate-900/90 to-slate-800/80 border border-white/10 p-8">
        <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
            <i data-lucide="history" class="h-6 w-6 text-teal-400"></i>
            Transaction History
        </h2>
        
        {% if transactions %}
            <div class="space-y-3">
                {% for transaction in transactions %}
                <div class="p-4 rounded-xl bg-white/5 border border-white/10 flex justify-between items-center">
                    <div class="flex items-center gap-3">
                        <div class="h-10 w-10 rounded-lg bg-gradient-to-br from-{% if transaction.transaction_type == 'Buy' %}blue-500 to-cyan-400{% elif transaction.transaction_type == 'Sell' %}red-500 to-pink-400{% else %}green-500 to-emerald-400{% endif %} flex items-center justify-center">
                            <i data-lucide="{% if transaction.transaction_type == 'Buy' %}arrow-down-circle{% elif transaction.transaction_type == 'Sell' %}arrow-up-circle{% else %}gift{% endif %}" class="h-5 w-5 text-white"></i>
                        </div>
                        <div>
                            <p class="font-semibold">{{ transaction.transaction_type }}</p>
                            <p class="text-sm text-slate-400">{{ transaction.transaction_date|date:"d M, Y - h:i A" }}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="font-bold text-lg {% if transaction.transaction_type == 'Buy' %}text-red-400{% else %}text-green-400{% endif %}">
                            {% if transaction.transaction_type == 'Buy' %}-{% else %}+{% endif %}₹{{ transaction.amount|floatformat:2 }}
                        </p>
                        <p class="text-xs text-slate-400">{{ transaction.reference_number }}</p>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <p class="text-slate-400 text-center py-8">No transactions yet</p>
        {% endif %}
    </div>
</div>
{% endblock %}






